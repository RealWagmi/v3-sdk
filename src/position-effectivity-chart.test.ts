import { PositionEffectivityChart } from './position-effectivity-chart';
import { metisTokens } from '@real-wagmi/sdk';
import { Pool, Position } from './entities';
import { FeeAmount } from './constants';

describe('PositionEffectivityChart', () => {
    describe('createChart', () => {
        it('should return chart data', () => {
            const pool = new Pool(metisTokens.wmetis, metisTokens.usdt, FeeAmount.MEDIUM, 613686879673364935458978n, 80161602339240196n, -235379);
            const position = new Position({ pool, liquidity: 43098425627875007n, tickLower: -235380, tickUpper: -235320 });
            // Arrange
            const zeroForSaleToken = true;
            const positions: Position[] = [position];
            const pointsNumber = 50;
            const marginPointsNumber = 50;

            // Act
            const result = PositionEffectivityChart.createChart(zeroForSaleToken, positions, pointsNumber, marginPointsNumber);

            // Assert
            expect(result).toEqual({
                loansChartData: [
                    {
                      amount: 1016209279n,
                      minPrice: 16669110591626702n,
                      maxPrice: 16569400343366657n
                    }
                ],
                aggressiveModeProfitLine: [
                    {
                      x: 16667309142916418n,
                      y: 0n
                    },
                    {
                      x: 16767702422505562n,
                      y: 5987300n
                    }
                ],
                chart: [
                    {
                      x: 16470582087447233n,
                      y: -2896937n
                    },
                    {
                      x: 16472549779913508n,
                      y: -2896937n
                    },
                    {
                      x: 16474517825012579n,
                      y: -2896937n
                    },
                    {
                      x: 16476486222828710n,
                      y: -2896937n
                    },
                    {
                      x: 16478454973446194n,
                      y: -2896937n
                    },
                    {
                      x: 16480424076949347n,
                      y: -2896937n
                    },
                    {
                      x: 16482393533422510n,
                      y: -2896937n
                    },
                    {
                      x: 16484363342950051n,
                      y: -2896937n
                    },
                    {
                      x: 16486333505616361n,
                      y: -2896937n
                    },
                    {
                      x: 16488304021505858n,
                      y: -2896937n
                    },
                    {
                      x: 16490274890702984n,
                      y: -2896937n
                    },
                    {
                      x: 16492246113292206n,
                      y: -2896937n
                    },
                    {
                      x: 16494217689358019n,
                      y: -2896937n
                    },
                    {
                      x: 16496189618984939n,
                      y: -2896937n
                    },
                    {
                      x: 16498161902257511n,
                      y: -2896937n
                    },
                    {
                      x: 16500134539260303n,
                      y: -2896937n
                    },
                    {
                      x: 16502107530077909n,
                      y: -2896937n
                    },
                    {
                      x: 16504080874794949n,
                      y: -2896937n
                    },
                    {
                      x: 16506054573496068n,
                      y: -2896937n
                    },
                    {
                      x: 16508028626265934n,
                      y: -2896937n
                    },
                    {
                      x: 16510003033189244n,
                      y: -2896937n
                    },
                    {
                      x: 16511977794350718n,
                      y: -2896937n
                    },
                    {
                      x: 16513952909835102n,
                      y: -2896937n
                    },
                    {
                      x: 16515928379727167n,
                      y: -2896937n
                    },
                    {
                      x: 16517904204111709n,
                      y: -2896937n
                    },
                    {
                      x: 16519880383073552n,
                      y: -2896937n
                    },
                    {
                      x: 16521856916697541n,
                      y: -2896937n
                    },
                    {
                      x: 16523833805068550n,
                      y: -2896937n
                    },
                    {
                      x: 16525811048271477n,
                      y: -2896937n
                    },
                    {
                      x: 16527788646391246n,
                      y: -2896937n
                    },
                    {
                      x: 16529766599512805n,
                      y: -2896937n
                    },
                    {
                      x: 16531744907721128n,
                      y: -2896937n
                    },
                    {
                      x: 16533723571101216n,
                      y: -2896937n
                    },
                    {
                      x: 16535702589738094n,
                      y: -2896937n
                    },
                    {
                      x: 16537681963716812n,
                      y: -2896937n
                    },
                    {
                      x: 16539661693122446n,
                      y: -2896937n
                    },
                    {
                      x: 16541641778040098n,
                      y: -2896937n
                    },
                    {
                      x: 16543622218554895n,
                      y: -2896937n
                    },
                    {
                      x: 16545603014751989n,
                      y: -2896937n
                    },
                    {
                      x: 16547584166716559n,
                      y: -2896937n
                    },
                    {
                      x: 16549565674533808n,
                      y: -2896937n
                    },
                    {
                      x: 16551547538288964n,
                      y: -2896937n
                    },
                    {
                      x: 16553529758067284n,
                      y: -2896937n
                    },
                    {
                      x: 16555512333954045n,
                      y: -2896937n
                    },
                    {
                      x: 16557495266034555n,
                      y: -2896937n
                    },
                    {
                      x: 16559478554394144n,
                      y: -2896937n
                    },
                    {
                      x: 16561462199118169n,
                      y: -2896937n
                    },
                    {
                      x: 16563446200292012n,
                      y: -2896937n
                    },
                    {
                      x: 16565430558001082n,
                      y: -2896937n
                    },
                    {
                      x: 16567415272330810n,
                      y: -2896937n
                    },
                    {
                      x: 16569400343366657n,
                      y: -2896937n
                    },
                    {
                      x: 16571385771194107n,
                      y: -2895735n
                    },
                    {
                      x: 16573371555898670n,
                      y: -2892131n
                    },
                    {
                      x: 16575357697565883n,
                      y: -2886122n
                    },
                    {
                      x: 16577344196281305n,
                      y: -2877711n
                    },
                    {
                      x: 16579331052130526n,
                      y: -2866896n
                    },
                    {
                      x: 16581318265199156n,
                      y: -2853679n
                    },
                    {
                      x: 16583305835572835n,
                      y: -2838058n
                    },
                    {
                      x: 16585293763337228n,
                      y: -2820033n
                    },
                    {
                      x: 16587282048578022n,
                      y: -2799606n
                    },
                    {
                      x: 16589270691380935n,
                      y: -2776776n
                    },
                    {
                      x: 16591259691831706n,
                      y: -2751541n
                    },
                    {
                      x: 16593249050016103n,
                      y: -2723904n
                    },
                    {
                      x: 16595238766019919n,
                      y: -2693864n
                    },
                    {
                      x: 16597228839928971n,
                      y: -2661421n
                    },
                    {
                      x: 16599219271829104n,
                      y: -2626574n
                    },
                    {
                      x: 16601210061806187n,
                      y: -2589323n
                    },
                    {
                      x: 16603201209946116n,
                      y: -2549671n
                    },
                    {
                      x: 16605192716334811n,
                      y: -2507614n
                    },
                    {
                      x: 16607184581058221n,
                      y: -2463154n
                    },
                    {
                      x: 16609176804202317n,
                      y: -2416291n
                    },
                    {
                      x: 16611169385853099n,
                      y: -2367026n
                    },
                    {
                      x: 16613162326096590n,
                      y: -2315356n
                    },
                    {
                      x: 16615155625018840n,
                      y: -2261283n
                    },
                    {
                      x: 16617149282705927n,
                      y: -2204808n
                    },
                    {
                      x: 16619143299243950n,
                      y: -2145929n
                    },
                    {
                      x: 16621137674719039n,
                      y: -2084646n
                    },
                    {
                      x: 16623132409217346n,
                      y: -2020960n
                    },
                    {
                      x: 16625127502825051n,
                      y: -1954872n
                    },
                    {
                      x: 16627122955628359n,
                      y: -1886380n
                    },
                    {
                      x: 16629118767713500n,
                      y: -1815485n
                    },
                    {
                      x: 16631114939166733n,
                      y: -1742186n
                    },
                    {
                      x: 16633111470074339n,
                      y: -1666485n
                    },
                    {
                      x: 16635108360522628n,
                      y: -1588380n
                    },
                    {
                      x: 16637105610597933n,
                      y: -1507872n
                    },
                    {
                      x: 16639103220386616n,
                      y: -1424960n
                    },
                    {
                      x: 16641101189975062n,
                      y: -1339646n
                    },
                    {
                      x: 16643099519449685n,
                      y: -1251928n
                    },
                    {
                      x: 16645098208896923n,
                      y: -1161807n
                    },
                    {
                      x: 16647097258403239n,
                      y: -1069284n
                    },
                    {
                      x: 16649096668055124n,
                      y: -974356n
                    },
                    {
                      x: 16651096437939094n,
                      y: -877025n
                    },
                    {
                      x: 16653096568141692n,
                      y: -777291n
                    },
                    {
                      x: 16655097058749485n,
                      y: -675155n
                    },
                    {
                      x: 16657097909849068n,
                      y: -570614n
                    },
                    {
                      x: 16659099121527061n,
                      y: -463670n
                    },
                    {
                      x: 16661100693870110n,
                      y: -354323n
                    },
                    {
                      x: 16663102626964887n,
                      y: -242574n
                    },
                    {
                      x: 16665104920898091n,
                      y: -128420n
                    },
                    {
                      x: 16667107575756446n,
                      y: -11864n
                    },
                    {
                      x: 16669110591626702n,
                      y: 107095n
                    },
                    {
                      x: 16671113968595636n,
                      y: 227253n
                    },
                    {
                      x: 16673117706750050n,
                      y: 347403n
                    },
                    {
                      x: 16675121806176772n,
                      y: 467547n
                    },
                    {
                      x: 16677126266962658n,
                      y: 587683n
                    },
                    {
                      x: 16679131089194588n,
                      y: 707811n
                    },
                    {
                      x: 16681136272959470n,
                      y: 827933n
                    },
                    {
                      x: 16683141818344235n,
                      y: 948047n
                    },
                    {
                      x: 16685147725435844n,
                      y: 1068155n
                    },
                    {
                      x: 16687153994321281n,
                      y: 1188254n
                    },
                    {
                      x: 16689160625087559n,
                      y: 1308347n
                    },
                    {
                      x: 16691167617821714n,
                      y: 1428433n
                    },
                    {
                      x: 16693174972610810n,
                      y: 1548511n
                    },
                    {
                      x: 16695182689541937n,
                      y: 1668582n
                    },
                    {
                      x: 16697190768702212n,
                      y: 1788646n
                    },
                    {
                      x: 16699199210178777n,
                      y: 1908702n
                    },
                    {
                      x: 16701208014058800n,
                      y: 2028752n
                    },
                    {
                      x: 16703217180429476n,
                      y: 2148794n
                    },
                    {
                      x: 16705226709378026n,
                      y: 2268829n
                    },
                    {
                      x: 16707236600991698n,
                      y: 2388857n
                    },
                    {
                      x: 16709246855357764n,
                      y: 2508877n
                    },
                    {
                      x: 16711257472563524n,
                      y: 2628890n
                    },
                    {
                      x: 16713268452696305n,
                      y: 2748896n
                    },
                    {
                      x: 16715279795843458n,
                      y: 2868895n
                    },
                    {
                      x: 16717291502092363n,
                      y: 2988887n
                    },
                    {
                      x: 16719303571530424n,
                      y: 3108871n
                    },
                    {
                      x: 16721316004245071n,
                      y: 3228848n
                    },
                    {
                      x: 16723328800323763n,
                      y: 3348818n
                    },
                    {
                      x: 16725341959853984n,
                      y: 3468781n
                    },
                    {
                      x: 16727355482923243n,
                      y: 3588737n
                    },
                    {
                      x: 16729369369619076n,
                      y: 3708685n
                    },
                    {
                      x: 16731383620029048n,
                      y: 3828626n
                    },
                    {
                      x: 16733398234240745n,
                      y: 3948560n
                    },
                    {
                      x: 16735413212341786n,
                      y: 4068486n
                    },
                    {
                      x: 16737428554419810n,
                      y: 4188406n
                    },
                    {
                      x: 16739444260562486n,
                      y: 4308318n
                    },
                    {
                      x: 16741460330857510n,
                      y: 4428223n
                    },
                    {
                      x: 16743476765392601n,
                      y: 4548121n
                    },
                    {
                      x: 16745493564255508n,
                      y: 4668011n
                    },
                    {
                      x: 16747510727534005n,
                      y: 4787895n
                    },
                    {
                      x: 16749528255315891n,
                      y: 4907771n
                    },
                    {
                      x: 16751546147688994n,
                      y: 5027640n
                    },
                    {
                      x: 16753564404741167n,
                      y: 5147501n
                    },
                    {
                      x: 16755583026560289n,
                      y: 5267356n
                    },
                    {
                      x: 16757602013234267n,
                      y: 5387203n
                    },
                    {
                      x: 16759621364851033n,
                      y: 5507043n
                    },
                    {
                      x: 16761641081498547n,
                      y: 5626876n
                    },
                    {
                      x: 16763661163264793n,
                      y: 5746701n
                    },
                    {
                      x: 16765681610237786n,
                      y: 5866520n
                    },
                    {
                      x: 16767702422505562n,
                      y: 5986331n
                    }
                ]
            });
        });
    });
});